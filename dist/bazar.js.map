{"version":3,"file":"bazar.js","sources":["../src/bazar.mjs"],"sourcesContent":["const dispatch = config => {\n  const { notifs = [] } = config;\n\n  // execute effects\n  notifs.forEach(notif => {\n    const current = _BAZAR_STORE_[notif];\n    if (!current) throw new Error('Trying to notify a non-existent component');\n\n    // creating states object\n    const states = {};\n    current.interests\n      .forEach(interest => states[interest] = _BAZAR_STORE_[interest].sync());\n\n    // pass states to avoid reading from global\n    // avoid expose global object\n    current.handler(states);\n  });\n};\n\nconst register = config => {\n  const {\n    id,\n    notifs = [],\n    interests = [],\n    handler = undefined,\n    sync = undefined,\n  } = config;\n\n  if (!id) throw new Error('Expected registrant to have non-null id value');\n  if (_BAZAR_STORE_.hasOwnProperty(id)) throw new Error('Expected unique id');\n\n  // create snapshop in global\n  _BAZAR_STORE_[id] = {\n    notifs,\n    interests,\n    handler,\n    sync,\n  };\n};\n\nconst initStore = () => {\n  const context = typeof global !== 'undefined'\n    ? global\n    : typeof self !== 'undefined'\n      ? self\n      : typeof window !== 'undefined'\n        ? window\n        : {};\n\n  context._BAZAR_STORE_ = {};\n};\n\nexport {\n  initStore,\n  register,\n  dispatch,\n};\n"],"names":["global","self","window","_BAZAR_STORE_","config","undefined","id","Error","hasOwnProperty","notifs","interests","handler","sync","forEach","notif","current","states","interest"],"mappings":"8BAyCoC,oBAAXA,OACnBA,OACgB,oBAATC,KACLA,KACkB,oBAAXC,OACLA,OACA,IAEAC,cAAgB,8BA9BTC,wCAGJ,qCACG,wCACFC,uCACHA,IAGJC,EAAI,MAAM,IAAIC,MAAM,oDACrBJ,cAAcK,eAAeF,GAAK,MAAM,IAAIC,MAAM,sBAGtDJ,cAAcG,GAAM,QAClBG,YACAC,UACAC,OACAC,8BApCaR,iCACE,IAGjBK,EAAOI,iBAAQC,OACPC,EAAUZ,cAAcW,OACzBC,EAAS,MAAM,IAAIR,MAAM,iDAGxBS,EAAS,GACfD,EAAQL,UACLG,iBAAQI,UAAYD,EAAOC,GAAYd,cAAcc,GAAUL,SAIlEG,EAAQJ,QAAQK"}